<Window x:Class="MMH.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MMH"
        mc:Ignorable="d"
        Title="MMH" Height="502" Width="672">
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Orientation="Vertical" Margin="10">
            <!-- Replaced the simple Label with a styled Border + TextBlock that has gradient background,
     gradient text, drop shadow glow and a short entrance animation. Paste directly in place of the Label. -->
            <Border HorizontalAlignment="Center"
        CornerRadius="8"
        Padding="12,8"
        Margin="0,6,0,10"
        SnapsToDevicePixels="True">

                <Border.Effect>
                    <DropShadowEffect Color="#88000000" BlurRadius="10" ShadowDepth="3"/>
                </Border.Effect>

                <Grid>
                    <TextBlock Text="MMH (Multi Monitor Helper)"
                   FontFamily="Segoe UI Semibold"
                   FontSize="18"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   TextOptions.TextFormattingMode="Ideal"
                   TextOptions.TextRenderingMode="ClearType"
                   RenderTransformOrigin="0.5,0.5"
                   Opacity="0.98">
                        <TextBlock.Foreground>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                <GradientStop Color="#FFFFFFFF" Offset="0.0"/>
                                <GradientStop Color="#FFE6F7FF" Offset="1.0"/>
                            </LinearGradientBrush>
                        </TextBlock.Foreground>

            <!-- subtle glow (named so we can animate opacity) -->
                        <TextBlock.Effect>
                            <DropShadowEffect x:Name="titleGlow"
                                  Color="#FFFFFFFF"
                                  BlurRadius="12"
                                  ShadowDepth="0"
                                  Opacity="0.0"/>
                        </TextBlock.Effect>

                        <TextBlock.RenderTransform>
                            <ScaleTransform x:Name="titleScale" ScaleX="1" ScaleY="1"/>
                        </TextBlock.RenderTransform>
                    </TextBlock>

                    <Grid.Triggers>
                        <EventTrigger RoutedEvent="FrameworkElement.Loaded">
                            <BeginStoryboard>
                                <Storyboard>
                                    <!-- pop / settle -->
                                    <DoubleAnimation Storyboard.TargetName="titleScale"
                                         Storyboard.TargetProperty="ScaleX"
                                         From="0.94" To="1.0"
                                         Duration="0:0:0.28"
                                         AccelerationRatio="0.2" DecelerationRatio="0.8"/>
                                    <DoubleAnimation Storyboard.TargetName="titleScale"
                                         Storyboard.TargetProperty="ScaleY"
                                         From="0.94" To="1.0"
                                         Duration="0:0:0.28"
                                         AccelerationRatio="0.2" DecelerationRatio="0.8"/>
                                    <!-- glow fade-in -->
                                    <DoubleAnimation Storyboard.TargetName="titleGlow"
                                         Storyboard.TargetProperty="Opacity"
                                         From="0.0" To="0.7"
                                         Duration="0:0:0.35"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Grid.Triggers>
                </Grid>
            </Border>

            <!-- Display count control -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,4,0,10">
                <TextBlock VerticalAlignment="Center" Margin="0,0,6,0">Displays:</TextBlock>
                <TextBox x:Name="DisplayCountTextBox" Width="25" Text="3" Margin="0,0,8,0" />
                <Button Content="Regenerate" Click="Regenerate_Click"/>
                <Button Content="Identify Monitors"
                    Width="150"
                    Click="IdentifyMonitors_Click"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Top" Margin="10,0,0,0"
                    />

            </StackPanel>

            <!-- Changed from a horizontal StackPanel to a 3-column Grid so GroupBoxes stretch equally -->
            <Grid Margin="0,10,0,10" HorizontalAlignment="Stretch" >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- Profile 1 -->
                <GroupBox Grid.Column="0" Margin="0,0,0,0" BorderBrush="#FFBBDDF0" Background="#FFF6FBFD" HorizontalAlignment="Stretch">
                    <GroupBox.Header>
                        <Border Background="#FFDCEFF6" Padding="6">
                            <TextBlock Text="Profile 1" FontWeight="Bold"/>
                        </Border>
                    </GroupBox.Header>

                    <StackPanel Margin="4">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,6,0,6">
                            <TextBlock VerticalAlignment="Center" Margin="0,0,6,0">Enable Displays</TextBlock>
                            <StackPanel Orientation="Horizontal" x:Name="Profile1_DisplaysPanel"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,4,0,4">
                            <TextBlock VerticalAlignment="Center" Margin="0,0,6,0">Default Monitor</TextBlock>
                            <StackPanel Orientation="Horizontal" x:Name="Profile1_PrimaryPanel"/>
                        </StackPanel>

                        <TextBlock Text="Description:" Margin="2,4,2,0" FontSize="10"/>
                        <TextBox x:Name="Profile1_Description" Height="50" TextWrapping="Wrap" AcceptsReturn="True" Margin="2"/>

                        <Button Content="Apply" Click="ApplyProfile1_Click" Margin="0,6,0,0" />
                    </StackPanel>
                </GroupBox>

                <!-- Profile 2 -->
                <GroupBox Grid.Column="1" Margin="0,0,0,0" BorderBrush="#FFBEE7C8" Background="#FFFBFEF6" HorizontalAlignment="Stretch">
                    <GroupBox.Header>
                        <Border Background="#FFE8F7D9" Padding="6">
                            <TextBlock Text="Profile 2" FontWeight="Bold"/>
                        </Border>
                    </GroupBox.Header>

                    <StackPanel Margin="4">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,6,0,6">
                            <TextBlock VerticalAlignment="Center" Margin="0,0,6,0">Enable Displays</TextBlock>
                            <StackPanel Orientation="Horizontal" x:Name="Profile2_DisplaysPanel"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,4,0,4">
                            <TextBlock VerticalAlignment="Center" Margin="0,0,6,0">Default Monitor</TextBlock>
                            <StackPanel Orientation="Horizontal" x:Name="Profile2_PrimaryPanel"/>
                        </StackPanel>

                        <TextBlock Text="Description:" Margin="2,4,2,0" FontSize="10"/>
                        <TextBox x:Name="Profile2_Description" Height="50" TextWrapping="Wrap" AcceptsReturn="True" Margin="2"/>

                        <Button Content="Apply" Click="ApplyProfile2_Click" Margin="0,6,0,0" />
                    </StackPanel>
                </GroupBox>

                <!-- Profile 3 -->
                <GroupBox Grid.Column="2" Margin="0,0,0,0" BorderBrush="#FFF0D1C4" Background="#FFFEFBF9" HorizontalAlignment="Stretch">
                    <GroupBox.Header>
                        <Border Background="#FFF7DBD0" Padding="6">
                            <TextBlock Text="Profile 3" FontWeight="Bold"/>
                        </Border>
                    </GroupBox.Header>

                    <StackPanel Margin="4">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,6,0,6">
                            <TextBlock VerticalAlignment="Center" Margin="0,0,6,0">Enable Displays</TextBlock>
                            <StackPanel Orientation="Horizontal" x:Name="Profile3_DisplaysPanel"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,4,0,4">
                            <TextBlock VerticalAlignment="Center" Margin="0,0,6,0">Default Monitor</TextBlock>
                            <StackPanel Orientation="Horizontal" x:Name="Profile3_PrimaryPanel"/>
                        </StackPanel>

                        <TextBlock Text="Description:" Margin="2,4,2,0" FontSize="10"/>
                        <TextBox x:Name="Profile3_Description" Height="50" TextWrapping="Wrap" AcceptsReturn="True" Margin="2"/>

                        <Button Content="Apply" Click="ApplyProfile3_Click" Margin="0,6,0,0" />
                    </StackPanel>
                </GroupBox>

            </Grid>

            <Grid Margin="2,4,13,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <TextBlock Grid.Row="0" Text="Script Preview:" FontSize="10"/>
                <TextBox Grid.Row="1" x:Name="ScriptPreview" 
                         IsReadOnly="True"
                         TextWrapping="Wrap"
                         VerticalScrollBarVisibility="Auto"
                         HorizontalScrollBarVisibility="Auto"
                         Height="110"
                         FontFamily="Consolas"
                         FontSize="12"/>

            </Grid>


        </StackPanel>
    </ScrollViewer>
</Window>
